<div class="whiteboard-container" [attr.data-mode]="mode()">
  <!-- Toolbar -->
  <div class="toolbar">
    <div class="toolbar-section">
      <label class="file-btn" for="openFile">Open SVG</label>
      <input
        #fileInput
        id="openFile"
        type="file"
        accept=".svg,image/svg+xml"
        (change)="onFileSelected($event)"
        hidden
      />
      <button class="action-btn" (click)="saveSVG()" title="Save as SVG">Save SVG</button>
    </div>

    <div class="toolbar-section">
      <label class="input-label">
        Color:
        <input
          type="color"
          [value]="currentColor()"
          (input)="currentColor.set($any($event.target).value)"
          class="color-picker"
        />
      </label>

      <label class="input-label">
        Width:
        <input
          type="range"
          min="1"
          max="40"
          [value]="strokeWidth()"
          (input)="strokeWidth.set(+$any($event.target).value)"
          class="width-slider"
        />
        <span class="width-value">{{ strokeWidth() }}px</span>
      </label>
    </div>

    <div class="toolbar-section mode-group">
      <label class="mode-radio">
        <input
          type="radio"
          name="mode"
          value="draw"
          [checked]="mode() === 'draw'"
          (change)="setMode('draw')"
        />
        Draw
      </label>
      <label class="mode-radio">
        <input
          type="radio"
          name="mode"
          value="pan"
          [checked]="mode() === 'pan'"
          (change)="setMode('pan')"
        />
        Pan
      </label>
      <label class="mode-radio">
        <input
          type="radio"
          name="mode"
          value="erase"
          [checked]="mode() === 'erase'"
          (change)="setMode('erase')"
        />
        Erase
      </label>
    </div>

    <div class="toolbar-section">
      <button class="action-btn danger" (click)="clearCanvas()" title="Clear canvas">Clear</button>
    </div>

    <span class="status">{{ status() }}</span>
  </div>

  <!-- SVG Canvas -->
  <div class="board-wrapper">
    <svg
      #svgCanvas
      class="svg-canvas"
      [style.cursor]="cursor()"
      (pointerdown)="onPointerDown($event)"
      (pointermove)="onPointerMove($event)"
      (pointerup)="onPointerUp($event)"
      (pointercancel)="onPointerCancel($event)"
      (pointerleave)="onPointerUp($event)"
      (wheel)="onWheel($event)"
      (auxclick)="$event.preventDefault()"
    >
      <!-- Hit area outside transform to always capture events -->
      <rect class="hit-area" x="0" y="0" width="100%" height="100%" fill="white"></rect>

      <!-- Content group with transform -->
      <g #contentGroup id="contentGroup" [attr.transform]="transform()">
        <!-- Paths rendered from signal (for persistence/save) are duplicates of DOM paths -->
        <!-- DOM paths are created directly for performance during drawing -->
      </g>
    </svg>
  </div>
</div>
